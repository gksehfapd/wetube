(()=>{const e=document.getElementById("videoContainer"),t=document.getElementById("commentForm"),n=document.getElementById("username");t&&t.addEventListener("submit",(async o=>{o.preventDefault();const a=t.querySelector("textarea"),d=n.innerText+" : "+a.value,m=e.dataset.id;if(""===d)return;const s=await fetch("/api/videos/".concat(m,"/comment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:d})});if(201===s.status){a.value="";const{newCommentId:e}=await s.json();((e,t)=>{const n=document.querySelector(".video__comments ul"),c=document.createElement("li");c.dataset.id=t,c.className="video__comment";const o=document.createElement("i");o.className="fas fa-comment";const a=document.createElement("span");a.innerText="".concat(e);const d=document.createElement("span");d.innerText="❌",d.id="delete__comment",c.appendChild(o),c.appendChild(a),c.appendChild(d),n.prepend(c)})(d,e);const t=document.getElementById("delete__comment");t.removeEventListener("click",c),t.addEventListener("click",c)}}));const c=async e=>{const t=e.srcElement.parentNode,{dataset:{id:n}}=t;await fetch("/api/comments/".concat(n,"/delete"),{method:"DELETE"}),t.remove()};let o=document.querySelectorAll("#delete__comment");o&&o.forEach((e=>{e.addEventListener("click",c)}))})();